<!DOCTYPE html>
<html lang="zxx">

<head>
    <title>Library</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11.0.16/dist/sweetalert2.all.min.js"></script>
   <script>
        addEventListener("load", function () {
            setTimeout(hideURLbar, 0);
        }, false);

        function hideURLbar() {
            window.scrollTo(0, 1);
        }

    const api_url = "http://35.154.104.127:8080/LMS/category/getAllCategories";
  
    async function getapi(url) {
        const response = await fetch(url,{
                method : 'GET',
                headers : {
                            'Content-Type' : 'application/json',
                            'token': localStorage.getItem("jwt")
                         }
            });
        var data = await response.json();
       // console.log(data['response']);
        if (response) {
           if(!response.ok){
                if(response.status=='401'){
                    //localStorage.removeItem('jwt');
                    //window.location.href = './login.html'
                    console.log(localStorage.getItem("jwt"));
                }
                return false;
           }
        }
        show(data.response);
}
getapi(api_url);

function show(data) {
    let tab = 
        `<thead class="thead-dark">
            <tr>
                <th scope="col">S.No.</th>
                <th scope="col">Category Name</th>
                <th scope="col">Status</th>
                <th scope="col">Action</th>
            </tr>
        </thead>
        <tbody>`;
    
    // Loop to access all rows 
    let sr = 0;
    //for (let r of data.list) 
    data.forEach(e => {
        sr++;
        tab += `<tr> 
        <th scope="row">${sr}</th>
        <td>${e.categories}</td>
        <td>${e.isActive == "1"? "Active" : "Inactive"}</td>
        <td> 
            <button type="button" class="btn btn-primary" onclick = "updateCategory('${e.categoryId}')"><i class="fa fa-edit"></i></button>
            <button type="button" class="btn btn-danger" onclick="deleteCategory('${e.categoryId}')"><i class="fa fa-trash"></i></button>
        </td>
        </tr>`;
        
    });
    tab += `</tbody>`;
        document.getElementById("categories").innerHTML = tab;
    }
    function updateCategory(catId){
        window.location.href = './update-categories.html?catId='+catId;
    }
    function deleteCategory(categoryId){
                Swal.fire({
            text: 'Are you sure to delete the Book?',
            icon: 'question',
            confirmButtonText: 'OK',
            showCancelButton: true,
        }).then(async (result) => {
            if (result.isConfirmed) {
            const url = "http://35.154.104.127:8080/LMS/category/removeCategory/"+categoryId; 
            const response = await fetch(url,{
                method : 'GET',
                headers : {
                            'Content-Type' : 'application/json',
                            'token': localStorage.getItem("jwt")
                        }
            });
                if (response.status == '200') {
                Swal.fire({
                    text: 'Book deleted',
                    icon: 'success',
                    confirmButtonText: 'OK'

                }).then((result) => {
                    if (result.isConfirmed) {
                    window.location.href = './manage-books.html';       
                    }
                });
                } else {
                Swal.fire({
                    text: objects['message'],
                    icon: 'error',
                    confirmButtonText: 'OK'
                });             
            }
        }
        });  
    return false;
}
    </script>
    <!-- Custom Theme files -->
    <link href="css/bootstrap.css" type="text/css" rel="stylesheet" media="all">
    <!-- shop css -->
    <link href="css/shop.css" type="text/css" rel="stylesheet" media="all">
    <link href="css/style.css" type="text/css" rel="stylesheet" media="all">
    <link href="css/common.css" type="text/css" rel="stylesheet" media="all">
    <!-- font-awesome icons -->
    <link href="css/font-awesome.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/css/select2.min.css" rel="stylesheet" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/select2/4.0.6-rc.0/js/select2.min.js"></script>
    <script src="js/header.js"></script>
</head>


<body id="page-top" data-spy="scroll" data-target=".navbar-fixed-top">
    <div id="home">
        <!-- header -->
        <!-- navbar -->
        <div id="header"></div>    
        <!-- //navbar ends here -->
<div class="spacer"></div>

            <!-- add authors form -->
            <div class="login-form section text-center">
                <div class="container">
                    <div class="panel-heading">
                        <div class="row">
                          <!-- breadcrumbs -->
        
                        <div class="col-md-9">
                              <ul class="btn-group btn-breadcrumb bc-list">
                                <li class="btn btn1">
                                  <a href="index.html">
                                    <i class="glyphicon glyphicon-home"></i>
                                  </a>
                                </li>
                                <li class="btn btn2">
                                    <a href="#">Admin</a>
                                </li>
                                <li class="btn btn3">
                                  <a href="manage-department.html">Manage Department</a>
                                </li>
                              </ul>
                        </div>
                          <!--//breadcrumbs ends here-->
        
                        </div>
        
                      </div>
                    <div class="col-md-12 toverflow">

                    <table class="table table-bordered" id="department">
                        <table class="table table-bordered">
                            <thead class="thead-dark">
                                <tr>
                                    <th scope="col">S.No.</th>
                                    <th scope="col">Department Name</th>
                                    <td scope="col">Status</td>
                                    <td scope="col">Action</td>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <th scope="row">1</th>
                                    <td>Information Technology</td>
                                    <td>Active</td>
                                    <td> <button type="button" class="btn btn-primary"><i class="fa fa-edit"></i></button>
                                        <button type="button" class="btn btn-danger"><i class="fa fa-trash"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <th scope="row">2</th>
                                    <td>Electrical Department</td>
                                    <td>Active</td>
                                    <td> <button type="button" class="btn btn-primary"><i class="fa fa-edit"></i></button>
                                        <button type="button" class="btn btn-danger"><i class="fa fa-trash"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <th scope="row">3</th>
                                    <td>Mechanical Department</td>
                                    <td>Active</td>
                                    <td> <button type="button" class="btn btn-primary"><i class="fa fa-edit"></i></button>
                                        <button type="button" class="btn btn-danger"><i class="fa fa-trash"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <th scope="row">4</th>
                                    <td>Law Department</td>
                                    <td>Active</td>
                                    <td> <button type="button" class="btn btn-primary"><i class="fa fa-edit"></i></button>
                                        <button type="button" class="btn btn-danger"><i class="fa fa-trash"></i></button>
                                    </td>
                                </tr>
                                <tr>
                                    <th scope="row">5</th>
                                    <td>Finance Department</td>
                                    <td>Active</td>
                                    <td> <button type="button" class="btn btn-primary"><i class="fa fa-edit"></i></button>
                                        <button type="button" class="btn btn-danger"><i class="fa fa-trash"></i></button>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </table>
                    <nav aria-label="..." class="float-right">
                        <ul class="pagination">
                          <li class="page-item disabled">
                            <a class="page-link" href="#" tabindex="-1">Previous</a>
                          </li>
                          <li class="page-item active"><a class="page-link" href="#">1</a></li>
                          <li class="page-item ">
                            <a class="page-link" href="#">2 <span class="sr-only">(current)</span></a>
                          </li>
                          <li class="page-item"><a class="page-link" href="#">3</a></li>
                          <li class="page-item">
                            <a class="page-link" href="#">Next</a>
                          </li>
                        </ul>
                      </nav>
                      </div>
                </div>
            </div>
        </div>
        <!--//add authors form ends here-->

    </div>

    <!-- //footer -->
    <div class="cpy-right">
        <p>© 2018 Library. All rights reserved | Design by
            <a href="#"> Library.</a>
        </p>
    </div>
<!-- //home -->
    <!-- js -->
    <script src="js/jquery-2.2.3.min.js"></script>
    <!-- //js -->
    <!--search jQuery-->
    <script src="js/main.js"></script>
    <!--search jQuery-->


    <!-- dropdown nav -->
    <script>
        $(document).ready(function () {
            $(".dropdown").hover(
                function () {
                    $('.dropdown-menu', this).stop(true, true).slideDown("fast");
                    $(this).toggleClass('open');
                },
                function () {
                    $('.dropdown-menu', this).stop(true, true).slideUp("fast");
                    $(this).toggleClass('open');
                }
            );
        });
    </script>
    <!-- //dropdown nav -->

    <!-- Scrolling Nav JavaScript -->
    <script src="js/scrolling-nav.js"></script>
    <!-- //fixed-scroll-nav-js -->
    <!-- start-smooth-scrolling -->
    <script src="js/move-top.js"></script>
    <script src="js/easing.js"></script>
    <script>
        jQuery(document).ready(function ($) {
            $(".scroll").click(function (event) {
                event.preventDefault();

                $('html,body').animate({
                    scrollTop: $(this.hash).offset().top
                }, 1000);
            });
        });
    </script>
    <!-- //end-smooth-scrolling -->
    <!-- smooth-scrolling-of-move-up -->
    <script>
        $(document).ready(function () {
            /*
            var defaults = {
                containerID: 'toTop', // fading element id
                containerHoverID: 'toTopHover', // fading element hover id
                scrollSpeed: 1200,
                easingType: 'linear' 
            };
            */

            $().UItoTop({
                easingType: 'easeOutQuart'
            });

        });
    </script>
    <script src="js/SmoothScroll.min.js"></script>
    <!-- //smooth-scrolling-of-move-up -->
    <!-- Bootstrap core JavaScript
 ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="js/bootstrap.js"></script>
</body>

</html>